<html>

<div width = "800" height = "60">
    <h1>My Snake Game</h1>
</div>
<canvas id="gameBanner" width="800" height="100"></canvas>
<canvas id="gameCanvas" width="800" height="600"></canvas>

<script>
    //banner area
    let banner;
    let bannerContext;
    let eatenApples = 0;

    //game area
    const WIDTH = 800;
    const HEIGHT = 600;

    let canvas;
    let canvasContext;

    //snake params
    let snakeContext;
    let snakeWidth = 50;
    const SNAKE_HEIGHT = 25;
    const INCREMENT = 5;
    let snakeX = Math.random() * WIDTH - snakeWidth;//x and y coordinates are from top left corner of snake.
    let snakeY = Math.random() * HEIGHT - SNAKE_HEIGHT;//must makesure snake starts fully on canvas
    let xIncrement = 0;
    let yIncrement = 0;

    //apple params
    let appleContext;
    const APPLE_RADIUS = 10;
    let appleX; //x and y coordinates are from center of circle
    let appleY;//this way the circle is fully in the canvas

    window.onload = () => {
        //banner area
        banner = document.getElementById('gameBanner');
        bannerContext = banner.getContext('2d');
        

        //game area
        canvas = document.getElementById('gameCanvas');
        snakeContext = canvas.getContext('2d');
        appleContext = canvas.getContext('2d');
        canvasContext = canvas.getContext('2d');
        appleReset();

        let framePerSecond = 30;
        let oneSecond = 1000;

        drawBanner();

        setInterval(() => {           
            moveEverything();
            drawEverything();
        }, oneSecond / framePerSecond);

        //arrows listener
        document.addEventListener('keydown', arrowPressed);
    };

    //reset apple position
    appleReset = () => {
        appleX = Math.random() * (WIDTH - APPLE_RADIUS * 2) + APPLE_RADIUS;
        appleY = Math.random() * (HEIGHT - APPLE_RADIUS * 2) + APPLE_RADIUS;
    }

    //arrow listener function
    arrowPressed = (event) =>{
        var code = event.which;
        switch (code) {
            //right arrow
            case 39:
                xIncrement = INCREMENT;
                yIncrement = 0;
                break;
            //left arrow
            case 37:
                xIncrement = -INCREMENT;
                yIncrement = 0;
                break;
            //up arrow
            case 38:
                yIncrement = -INCREMENT;
                xIncrement = 0;
                break;
            //down arrow
            case 40:
                yIncrement = INCREMENT;
                xIncrement = 0;
                break;
        }
    };

    //make snake move
    moveEverything = () => {
        snakeX += xIncrement;
        snakeY += yIncrement;

        //keeping snake in canvas
        if(snakeX > WIDTH)
            snakeX = 0;
        if(snakeX < 0){
            snakeX = WIDTH;
        }
        if(snakeY > HEIGHT){
            snakeY = 0;
        }
        if(snakeY < 0){
            snakeY = HEIGHT;
        }

        //collission
        if((snakeY > appleY - APPLE_RADIUS && snakeY < appleY + APPLE_RADIUS) 
        && (snakeX > appleX - APPLE_RADIUS && snakeX < appleX + APPLE_RADIUS)  ) 
        {
            eatenApples++;
            drawBanner();
            appleReset();
        }
    }

    drawBanner = () =>{      
        colorRect(bannerContext, 0, 0, banner.width, banner.height, 'white');
        bannerContext.font = "30px Arial";
        bannerContext.fillStyle = 'black';
        bannerContext.fillText("Apples Eaten: " + eatenApples, 50, 30);
    }
    drawEverything = () => {
        //canvas
        colorRect(canvasContext, 0, 0, canvas.width, canvas.height, 'black');
        //snake
        colorRect(snakeContext, snakeX, snakeY, snakeWidth, SNAKE_HEIGHT, 'green');
        //apple     
        colorCircle(appleContext, appleX, appleY, APPLE_RADIUS, 'red');
    };

    //create rectangle
    colorRect = (element, distanceX, distanceY, shapeHeight, shapeWidth, color) => {
        element.fillStyle = color;
        element.fillRect(distanceX, distanceY, shapeHeight, shapeWidth);
    };

    //create circle
    colorCircle = (element, distanceX, distanceY, radius, color) => {
        element.fillStyle = color;
        element.beginPath();
        element.arc(distanceX, distanceY, radius, 0, Math.PI * 2, true);
        element.fill();
    }

</script>

</html>